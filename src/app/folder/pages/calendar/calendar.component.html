<ion-toolbar class="ion-text-center" *ngIf="dateNavigator.currentMonth.length">
    <ion-title size="large">
        <ion-row>
            <ion-col size="2" class="pos-rel" style="top: 1.2rem">
                <div class="header-buttons">
                    <ion-icon src="assets/custom_icons/left_arrow.svg"
                        (click)="handleMonthNavigatorClick(dateNavigator.previousMonth)"
                        [ngStyle]="{'pointer-events': loading ? 'none' : 'initial'}">
                    </ion-icon>
                </div>
            </ion-col>
            <ion-col size="8">
                <p size="large">
                    <ng-container *ngIf="loading; else dateNavigatorLoaded">
                        <ion-skeleton-text [animated]="true" style="width: 220px; height: 30px;"></ion-skeleton-text>
                    </ng-container>
                    <ng-template #dateNavigatorLoaded>
                        {{ dateNavigator.currentMonth }}
                    </ng-template>
                </p>
            </ion-col>
            <ion-col size="2" class="pos-rel" style="top: 1.2rem">
                <div class="header-buttons">
                    <ion-icon src="assets/custom_icons/right_arrow.svg"
                        (click)="handleMonthNavigatorClick(dateNavigator.nextMonth)"
                        [ngStyle]="{'pointer-events': loading ? 'none' : 'initial'}">
                    </ion-icon>
                </div>
            </ion-col>
        </ion-row>
    </ion-title>
</ion-toolbar>
<ion-content [fullscreen]="true">
    <ng-container>
        <app-calendar-view [viewDate]="calendarDate" [skeleton]="loading" [events]="calendarEvents"
            (dayClickedOutput)="handleDayClicked($event)">
        </app-calendar-view>
    </ng-container>
    <ng-container *ngTemplateOutlet="legendTemplate"></ng-container>
    <ion-list style="padding-bottom: 5rem;">
        <ng-container *ngIf="!loading; else skeletonList">
            <div *ngFor="let item of eventsList | listEvents:dayClicked">
                <ion-title style="text-transform: capitalize; margin-top: 10px; margin-bottom: 5px;">{{
                    formatDate(item.date) }}
                </ion-title>
                <div *ngIf="item.publications && item.publications.length > 0">
                    <ion-item *ngFor="let p of item.publications" style="padding-left: 1em;" class="item-avatar">
                        <ion-img [src]="p.img" [alt]="p.title"></ion-img>
                        <ion-label>
                            <p style="white-space: break-spaces;">{{ p.title }}</p>
                            <p><small>{{ p.publishHouse }}</small></p>
                        </ion-label>
                    </ion-item>
                </div>
            </div>
        </ng-container>
        <ng-template #skeletonList>
            <ng-container *ngFor="let item of [0, 1, 2, 3]">
                <ion-title style="margin-top: 16px">
                    <ion-skeleton-text [animated]="true" style="width: 140px"></ion-skeleton-text>
                </ion-title>
                <ion-item>
                    <ion-thumbnail>
                        <ion-skeleton-text [animated]="true" style="width: 110px; height: 150px;">
                        </ion-skeleton-text>
                    </ion-thumbnail>
                    <ion-label style="margin-left: 36px">
                        <ion-skeleton-text [animated]="true" style="width: 160px"></ion-skeleton-text>
                    </ion-label>
                </ion-item>
            </ng-container>
        </ng-template>
    </ion-list>
</ion-content>
<ng-template #legendTemplate>
    <ion-accordion-group>
        <ion-accordion value="editoriales">
            <ion-item slot="header">
                <ion-label>Editoriales</ion-label>
            </ion-item>
            <ion-grid slot="content">
                <ion-row>
                    <ion-col size="6" *ngFor="let item of publishHouseLegend">
                        <ion-chip #chip mode="md" style="width: 100%;" [outline]="true"
                            (click)="handleEditorialClick(item, chip, $event)">
                            <ion-icon [src]="item.color"></ion-icon>
                            <ion-label [ngClass]="{'break-label': item.publishHouse!.length > 10}">
                                {{ item.publishHouse }}
                            </ion-label>
                            <ion-icon *ngIf="!chip.outline" name="close-circle"
                                style="position: absolute; right: 1rem;"></ion-icon>
                        </ion-chip>
                        <!-- <div style="width: 16px !important; height: 16px !important;">
                            <ion-icon slot="start" [src]="item.color"></ion-icon>
                        </div>
                        <div>
                            <ion-label class="ion-text-wrap" (click)="handleEditorialClick(item)">
                                <p class="text-13 black">{{item.publishHouse}}</p>
                            </ion-label>
                        </div> -->
                    </ion-col>
                </ion-row>
            </ion-grid>
        </ion-accordion>
    </ion-accordion-group>
</ng-template>
<!-- <app-calendar-view></app-calendar-view> -->